<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<title>Sim MSFS - Vue Passager + Cesium + Logs</title>
<!-- HEAD -->
<script src="https://cdn.jsdelivr.net/npm/cesium@1.111.0/Build/Cesium/Cesium.js"></script>
<link href="https://cdn.jsdelivr.net/npm/cesium@1.111.0/Build/Cesium/Widgets/widgets.css" rel="stylesheet" />
<style>
  html, body {
    margin: 0; padding: 0; height: 100%; overflow: hidden;
    font-family: Arial, sans-serif;
    background: #000;
    color: #eee;
  }
  #cesiumContainer {
    position: absolute; top: 0; left: 0; right: 300px; bottom: 0;
  }
  #logbox {
    position: absolute;
    top: 0; right: 0;
    width: 300px; height: 100%;
    background: #111;
    overflow-y: auto;
    padding: 10px;
    box-sizing: border-box;
    font-size: 14px;
    border-left: 1px solid #444;
  }
  #logbox pre {
    white-space: pre-wrap;
  }
</style>
</head>
<body>

<div id="cesiumContainer"></div>
<div id="logbox"><pre id="log"></pre></div>

<script src="https://cdn.jsdelivr.net/npm/cesium@1.111.0/Build/Cesium/Cesium.js"></script>
<script>
  // Ta clé Cesium Ion (remplace par la tienne)
  Cesium.Ion.defaultAccessToken = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiI4N2QzNDMyNy0yN2I5LTRjYTQtYWY4Ny0wMTJiYzMxMTg0NWUiLCJpZCI6MjExODk3LCJpYXQiOjE3NDkzODM4NjJ9.-gzSpbdgPagQUWw9PxgljLi-hQtVaohFj185K2XqvFs';

  const logElement = document.getElementById('log');
  function log(msg) {
    const time = new Date().toLocaleTimeString();
    logElement.textContent += `[${time}] ${msg}\n`;
    logElement.scrollTop = logElement.scrollHeight;
  }

  log("Initialisation Cesium...");

  // Création du viewer Cesium avec terrain réaliste
  const viewer = new Cesium.Viewer('cesiumContainer', {
    terrainProvider: Cesium.IonResource.fromAssetId(1).then(function(resource) {
  return new Cesium.CesiumTerrainProvider({ url: resource });
})


  log("Cesium initialisé avec terrain WorldTerrain.");

  // Position et orientation initiale (exemple Paris)
  let position = {
    lat: 48.8566,
    lon: 2.3522,
    alt: 3000
  };
  let pseudo = "KYKYGosed_off";
  let flightNumber = "MSFS1234";

  // Positionne la caméra sur la position initiale
  function setCameraView(pos) {
    viewer.camera.setView({
      destination: Cesium.Cartesian3.fromDegrees(pos.lon, pos.lat, pos.alt),
      orientation: {
        heading: 0,
        pitch: Cesium.Math.toRadians(-35),
        roll: 0
      }
    });
    log(`Caméra positionnée sur lat: ${pos.lat.toFixed(4)}, lon: ${pos.lon.toFixed(4)}, alt: ${pos.alt}m`);
  }

  setCameraView(position);

  // Simuler réception périodique de données (ex: de Volanta ou SimConnect)
  function simulatePositionUpdate() {
    // On déplace la position un peu (par exemple longitude + 0.001)
    position.lon += 0.001;

    // Mise à jour de la caméra
    setCameraView(position);

    // Log update
    log(`Position mise à jour - vol: ${flightNumber}, pilote: ${pseudo}`);
  }

  // Simuler réception toutes les 3 secondes
  setInterval(simulatePositionUpdate, 3000);

  log("Simulation de mise à jour de position démarrée.");

</script>

</body>
</html>
